<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDoS Request Receiver - Test Tool</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            background: #0f0f0f;
            color: #00ff00;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            padding: 20px;
            background: #1a1a1a;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-box {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #00ff00;
        }
        .stat-label {
            font-size: 0.9em;
            color: #888;
        }
        .log-container {
            background: #000;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            height: 400px;
            overflow-y: auto;
        }
        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid #222;
        }
        .timestamp {
            color: #888;
            font-size: 0.8em;
        }
        .ip-address {
            color: #00ffff;
        }
        .method {
            color: #ffff00;
            font-weight: bold;
        }
        .user-agent {
            color: #ff00ff;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background: #00cc00;
        }
        button.reset {
            background: #ff4444;
            color: white;
        }
        button.reset:hover {
            background: #cc0000;
        }
        .chart {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .requests-per-sec {
            height: 100px;
            display: flex;
            align-items: end;
            gap: 2px;
        }
        .bar {
            background: #00ff00;
            flex: 1;
            min-height: 1px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ”¥ DDoS Request Receiver</h1>
            <p>Tool untuk test DDoS tool buatan lu - Pantau request yang masuk real-time!</p>
        </div>

        <div class="controls">
            <button onclick="startServer()">Start Receiver</button>
            <button onclick="stopServer()">Stop Receiver</button>
            <button class="reset" onclick="resetStats()">Reset All Stats</button>
        </div>

        <div class="stats-grid">
            <div class="stat-box">
                <div class="stat-number" id="totalRequests">0</div>
                <div class="stat-label">Total Requests</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="requestsPerSecond">0</div>
                <div class="stat-label">Requests/Sec</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="uniqueIPs">0</div>
                <div class="stat-label">Unique IPs</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="activeConnections">0</div>
                <div class="stat-label">Active Connections</div>
            </div>
        </div>

        <div class="chart">
            <h3>ðŸ“ˆ Requests Per Second (Last 60 seconds)</h3>
            <div class="requests-per-sec" id="rpsChart"></div>
        </div>

        <div class="log-container" id="logContainer">
            <div class="log-entry" style="color: #888;">
                Receiver ready. Start server to begin monitoring requests...
            </div>
        </div>
    </div>

    <script>
        class RequestReceiver {
            constructor() {
                this.stats = {
                    totalRequests: 0,
                    requestsPerSecond: 0,
                    uniqueIPs: new Set(),
                    activeConnections: 0,
                    startTime: null
                };
                this.rpsHistory = Array(60).fill(0);
                this.requestLog = [];
                this.isRunning = false;
                this.lastSecondCount = 0;
                this.currentSecond = Math.floor(Date.now() / 1000);
            }

            start() {
                this.isRunning = true;
                this.stats.startTime = Date.now();
                this.updateDisplay();
                this.log('ðŸš€ Receiver started - Ready to receive requests');
            }

            stop() {
                this.isRunning = false;
                this.log('ðŸ›‘ Receiver stopped');
            }

            reset() {
                this.stats = {
                    totalRequests: 0,
                    requestsPerSecond: 0,
                    uniqueIPs: new Set(),
                    activeConnections: 0,
                    startTime: this.isRunning ? Date.now() : null
                };
                this.rpsHistory = Array(60).fill(0);
                this.requestLog = [];
                this.updateDisplay();
                this.log('ðŸ”„ All stats reset');
            }

            simulateRequest() {
                if (!this.isRunning) return;

                const now = Date.now();
                const currentSecond = Math.floor(now / 1000);
                
                // Reset counter if new second
                if (currentSecond !== this.currentSecond) {
                    this.rpsHistory.push(this.lastSecondCount);
                    this.rpsHistory.shift();
                    this.stats.requestsPerSecond = this.lastSecondCount;
                    this.lastSecondCount = 0;
                    this.currentSecond = currentSecond;
                }

                this.lastSecondCount++;
                this.stats.totalRequests++;
                this.stats.activeConnections++;

                // Simulate random IP
                const fakeIP = `192.168.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
                this.stats.uniqueIPs.add(fakeIP);

                // Simulate different methods
                const methods = ['GET', 'POST', 'PUT', 'DELETE'];
                const method = methods[Math.floor(Math.random() * methods.length)];

                // Simulate user agents
                const userAgents = [
                    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
                    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',
                    'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36',
                    'DDoS-Tool/1.0',
                    'Python-urllib/3.10'
                ];
                const userAgent = userAgents[Math.floor(Math.random() * userAgents.length)];

                this.logRequest(method, fakeIP, userAgent);

                // Simulate connection duration
                setTimeout(() => {
                    this.stats.activeConnections--;
                    this.updateDisplay();
                }, Math.random() * 5000 + 1000);

                this.updateDisplay();
            }

            logRequest(method, ip, userAgent) {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = `
                    <span class="timestamp">[${timestamp}]</span>
                    <span class="method">${method}</span> 
                    from <span class="ip-address">${ip}</span>
                    <span class="user-agent">${userAgent}</span>
                `;
                
                const logContainer = document.getElementById('logContainer');
                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;

                // Keep only last 1000 entries
                this.requestLog.push(logEntry);
                if (this.requestLog.length > 1000) {
                    const oldEntry = this.requestLog.shift();
                    if (oldEntry.parentNode) {
                        oldEntry.parentNode.removeChild(oldEntry);
                    }
                }
            }

            log(message) {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.style.color = '#ffff00';
                logEntry.innerHTML = `<span class="timestamp">[${timestamp}]</span> ${message}`;
                
                const logContainer = document.getElementById('logContainer');
                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;
            }

            updateDisplay() {
                document.getElementById('totalRequests').textContent = this.stats.totalRequests.toLocaleString();
                document.getElementById('requestsPerSecond').textContent = this.stats.requestsPerSecond;
                document.getElementById('uniqueIPs').textContent = this.stats.uniqueIPs.size;
                document.getElementById('activeConnections').textContent = this.stats.activeConnections;

                // Update chart
                this.updateChart();
            }

            updateChart() {
                const chart = document.getElementById('rpsChart');
                chart.innerHTML = '';
                
                const maxRPS = Math.max(...this.rpsHistory, 1);
                
                this.rpsHistory.forEach(rps => {
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    const height = (rps / maxRPS) * 100;
                    bar.style.height = `${height}%`;
                    bar.title = `${rps} requests`;
                    chart.appendChild(bar);
                });
            }
        }

        const receiver = new RequestReceiver();

        function startServer() {
            receiver.start();
            
            // Simulate incoming requests (for demo)
            // Ini bisa lu ganti dengan real requests dari DDoS tool lu
            const interval = setInterval(() => {
                if (!receiver.isRunning) {
                    clearInterval(interval);
                    return;
                }
                
                // Simulate random burst of requests
                const requestCount = Math.floor(Math.random() * 10) + 1;
                for (let i = 0; i < requestCount; i++) {
                    setTimeout(() => receiver.simulateRequest(), Math.random() * 1000);
                }
            }, 1000);
        }

        function stopServer() {
            receiver.stop();
        }

        function resetStats() {
            receiver.reset();
        }

        // Auto-start for demo
        // startServer();

        // Export untuk testing dari external tools
        window.RequestReceiver = receiver;
    </script>
</body>
</html>
